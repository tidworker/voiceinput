// 若是 custom 階段 => 顯示「數量」與「確認」按鈕
if (currentCategory === "custom") {
  const toolDiv = document.getElementById("customToolsContainer");
  toolDiv.innerHTML = "";
  toolDiv.style.display = "flex";

  const qtyBtn = document.createElement("button");
  qtyBtn.textContent = "數量";
  qtyBtn.addEventListener("click", () => {
    currentDbIndex = 1; // 回到 amount 階段
    updateFloatingSuggestions();
  });

  const confirmBtn = document.createElement("button");
  confirmBtn.textContent = "確認";
  confirmBtn.addEventListener("click", () => {
    let mealLabel = selectedLabels[0];
    let amountLabel = selectedLabels[1];
    let totalPrice = 0;
    if (mealLabel && mealLabel.candidatePrice != null) {
      let mealPrice = mealLabel.candidatePrice;
      let amtVal = parseFloat(amountLabel?.tagName || "0");
      if (!isNaN(mealPrice) && !isNaN(amtVal)) {
        totalPrice = mealPrice * amtVal;
      }
    }
    grandTotal += totalPrice;
    itemList.push(currentLine);
    currentLine = "";
    currentDbIndex = 0;
    selectedLabels = [];
    clearCanvasOnly();
    toolDiv.innerHTML = "";
    toolDiv.style.display = "none";

    updateOutputField();
    updateFloatingSuggestions();
  });

  toolDiv.appendChild(qtyBtn);
  toolDiv.appendChild(confirmBtn);
} else {
  // 非 custom 階段隱藏工具列
  const toolDiv = document.getElementById("customToolsContainer");
  toolDiv.innerHTML = "";
  toolDiv.style.display = "none";
}