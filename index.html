<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>中文點餐系統</title>
  <style>
    /* 防止下拉刷新 */
    html, body {
      overscroll-behavior: none;
    }
    body {
      font-family: Arial, sans-serif;
      margin: 10px;
      padding: 0;
      background-color: black;
      color: white;
      text-align: center;
      user-select: none;
    }
    /* 圖片（Logo或標題） */
    img {
      max-width: 100%;
    }
    /* 主要內容區：訂單表格與語音備忘錄顯示 */
    #contentContainer {
      width: 90%;
      height: 370px;
      margin: 20px auto;
      overflow-y: auto;
      background-color: black;
    }
    /* 訂單表格 */
    table {
      width: 100%;
      background-color: black;
      color: white;
      border-collapse: separate;
      border-spacing: 0;
      border-radius: 3px;
    }
    table, th, td {
      border: 0;
    }
    th, td {
      padding: 8px;
      text-align: left;
    }
    table th {
      background-color: orange;
      color: black;
    }
    thead tr th:first-child {
      border-top-left-radius: 3px;
    }
    thead tr th:last-child {
      border-top-right-radius: 3px;
    }
    /* 語音備忘錄顯示區 */
    #voiceOutput {
      margin-top: 10px;
      text-align: left;
      color: orange;
      padding: 10px;
      background-color: black;
      cursor: pointer;
    }
    /* 總金額 */
    #totalAmount {
      color: white;
      font-size: 18px;
      margin-top: 10px;
    }
    /* 功能按鈕 */
    button {
      background-color: black;
      border: none;
      cursor: pointer;
      width: 50px;
      height: 50px;
      padding: 0;
      margin-top: 5px;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <!-- 頁首圖片 -->
  <br>
  <img src="3.png" width="340" height="170" alt="Logo">
  <!-- 訂單與備忘錄顯示區 -->
  <div id="contentContainer">
    <table id="orderTable">
      <thead>
        <tr>
          <th>品項</th>
          <th>份數</th>
          <th>備註</th>
          <th>單價</th>
        </tr>
      </thead>
      <tbody>
        <!-- 訂單項目將由程式碼動態插入 -->
      </tbody>
    </table>
    <!-- 語音備忘錄顯示（點擊進入編輯模式，原有功能保留） -->
    <div id="voiceOutput" onclick="openMemoModal()">語音備忘錄</div>
  </div>
  <p id="totalAmount">總金額：0 元</p>
  <!-- 功能按鈕 -->
  <button id="resetButton" onclick="resetOrder()">
    <img src="re.png" width="50" height="50" alt="重置">
  </button>
  <button id="ordersLinkButton" onclick="window.location.href='orders.html'">
    <img src="list.png" width="50" height="50" alt="訂單記錄">
  </button>
  <button id="completeOrderButton" onclick="completeOrder()">
    <img src="order.png" width="50" height="50" alt="完成訂單">
  </button>
  
  <!-- 以下為程式碼部分 -->
  <script>
    /* ------------------ 原有訂單功能（保留原有邏輯） ------------------ */
    function resetOrder() {
      document.getElementById("orderTable").getElementsByTagName("tbody")[0].innerHTML = "";
      document.getElementById("totalAmount").innerText = "總金額：0 元";
      document.getElementById("voiceOutput").innerText = "語音備忘錄";
      localStorage.removeItem("currentOrderData");
    }
    function completeOrder() {
      // 此處執行完成訂單的動作（示例以 alert 示意）
      alert("訂單已完成！");
      resetOrder();
    }
    // 其他原有訂單與語音處理功能略…

    /* ------------------ 備忘錄模態框功能 ------------------ */
    function openMemoModal() {
      const memo = prompt("請輸入備忘錄內容：", document.getElementById("voiceOutput").innerText);
      if (memo !== null) {
        document.getElementById("voiceOutput").innerText = memo;
      }
    }
    
    /* ------------------ 連點三下重新整理 ------------------ */
    let tapCount = 0;
    let lastTapTime = 0;
    document.addEventListener("click", function(e) {
      // 僅在螢幕下半部 25% 區域內計算連點
      if (e.clientY < window.innerHeight * 0.75) return;
      let now = Date.now();
      if (now - lastTapTime < 1000) {
        tapCount++;
      } else {
        tapCount = 1;
      }
      lastTapTime = now;
      if (tapCount >= 3) {
        location.reload();
      }
    });
    
    /* ------------------ 左滑換頁功能 ------------------ */
    let leftSwipeStartX = null;
    let leftSwipeStartTime = null;
    document.addEventListener("touchstart", function(e) {
      if (e.touches.length === 1) {
        leftSwipeStartX = e.touches[0].clientX;
        leftSwipeStartTime = Date.now();
      }
    });
    document.addEventListener("touchend", function(e) {
      if (leftSwipeStartX === null) return;
      const endX = e.changedTouches[0].clientX;
      const deltaX = endX - leftSwipeStartX;
      const duration = Date.now() - leftSwipeStartTime;
      // 只有當左滑距離超過 90px 且放開手指的時間在 1 秒內時才觸發
      if (deltaX < -90 && duration < 1000) {
        window.location.href = "orders.html";
      }
      leftSwipeStartX = null;
      leftSwipeStartTime = null;
    });
  </script>
</body>
</html>